<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LoadRunner Enterprise Test Report</title>
</head>
<body style="margin:0; padding:20px; font-family:Segoe UI, Tahoma, Geneva, Verdana, sans-serif; background:#f5f7f9; color:#333;">
<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" style="max-width:800px; margin:0 auto; background:#ffffff; border-radius:12px;">

    <!-- Header (converted to table for Outlook compatibility) -->
    <tr>
        <td bgcolor="#764ba2" style="padding:32px; text-align:center; color:#ffffff; border-top-left-radius:12px; border-top-right-radius:12px;">
            <table width="100%" cellpadding="0" cellspacing="0" border="0" align="center">
                <tr>
                    <td align="center" style="text-align:center;">
                        <h1 style="margin:0; font-size:24px; font-weight:600; color:#ffffff;">
                            LoadRunner Enterprise Test Report - Run ID ${RunID}
                        </h1>
                    </td>
                </tr>
                <tr>
                    <td align="center" style="padding-top:15px;">
                        <table cellpadding="0" cellspacing="0" border="0" style="background:${StatusBadgeColor}; border-radius:20px;">
                            <tr>
                                <td style="padding:8px 20px; font-weight:600; font-size:14px; color:#ffffff; text-align:center;">
                                    ${RunStatus} | ${RunResult}
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </td>
    </tr>

    <!-- Summary -->
    <tr>
        <td style="padding:28px; font-size:14px; line-height:1.6; color:#2c3e50;">
            <p>Hello Team,</p>
            <p>The performance test run for <strong>${TestName} (Run Id ${RunID})</strong> has completed. Below is a high-level summary of the results.</p>
            <p>For detailed analysis and system resource graphs, please view the full report in LoadRunner Enterprise.</p>
        </td>
    </tr>

    <!-- Metrics -->
    <tr>
        <td style="padding:25px;">
            <h3 style="margin-bottom:15px; color:#2c3e50;">High level metrics</h3>

            <table width="100%" cellpadding="0" cellspacing="0" border="0">

                <!-- Row 1 -->
                <tr>
                    <td width="32%" bgcolor="#e6f9f0" style="border-left:5px solid #28a745; padding:22px; text-align:center; border-radius:6px;">
                        <div style="font-size:22px; font-weight:700; color:#28a745;">${TransactionPassed}</div>
                        <div style="font-size:12px; color:#34495e; font-weight:500;">Transactions Passed</div>
                    </td>
                    <td width="2%"></td>
                    <td width="32%" bgcolor="#fdecea" style="border-left:5px solid #dc3545; padding:22px; text-align:center; border-radius:6px;">
                        <div style="font-size:22px; font-weight:700; color:#dc3545;">${TransactionFailed}</div>
                        <div style="font-size:12px; color:#34495e; font-weight:500;">Transactions Failed</div>
                    </td>
                    <td width="2%"></td>
                    <td width="32%" bgcolor="#e7f1ff" style="border-left:5px solid #007bff; padding:22px; text-align:center; border-radius:6px;">
                        <div style="font-size:22px; font-weight:700; color:#007bff;">${Vusers}</div>
                        <div style="font-size:12px; color:#34495e; font-weight:500;">Virtual Users</div>
                    </td>
                </tr>

                <tr><td colspan="7" height="14"></td></tr>

                <!-- Row 2 -->
                <tr>
                    <td width="32%" bgcolor="#fff7e6" style="border-left:5px solid #ff9800; padding:22px; text-align:center; border-radius:6px;">
                        <div style="font-size:22px; font-weight:700; color:#ff9800;">${TransactionPerSec}</div>
                        <div style="font-size:12px; color:#34495e; font-weight:500;">Transactions/Sec</div>
                    </td>
                    <td width="2%"></td>
                    <td width="32%" bgcolor="#f0f0f0" style="border-left:5px solid #6c757d; padding:22px; text-align:center; border-radius:6px;">
                        <div style="font-size:22px; font-weight:700; color:#6c757d;">${HitsPerSec}</div>
                        <div style="font-size:12px; color:#34495e; font-weight:500;">Hits/Sec</div>
                    </td>
                    <td width="2%"></td>
                    <td width="32%" bgcolor="#f9f0ff" style="border-left:5px solid #9c27b0; padding:22px; text-align:center; border-radius:6px;">
                        <div style="font-size:22px; font-weight:700; color:#9c27b0;">${AvgThroughput}</div>
                        <div style="font-size:12px; color:#34495e; font-weight:500;">Avg Throughput</div>
                    </td>
                </tr>
            </table>
        </td>
    </tr>

    <!-- Info Grid -->
    <tr>
        <td style="padding:25px;">
            <h3 style="margin-bottom:15px; color:#2c3e50;">Test Details</h3>

            <table width="100%" cellpadding="0" cellspacing="0" border="0">

                <!-- Each row follows same format, so we preserve your spacing -->
                <!-- Row 1 -->
                <tr>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Start Time</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${StartTime}</div>
                    </td>
                    <td width="2%"></td>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">End Time</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${EndTime}</div>
                    </td>
                    <td width="2%"></td>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Test Duration</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${TestDuration}</div>
                    </td>
                </tr>

                <!-- Additional rows (same pattern) -->
                <tr><td colspan="1" height="8"></td></tr>

                <tr>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Errors</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${Errors}</div>
                    </td>
                    <td width="2%"></td>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Domain</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${Domain}</div>
                    </td>
                    <td width="2%"></td>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Project</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${Project}</div>
                    </td>
                </tr>

                <tr><td colspan="1" height="8"></td></tr>

                <tr>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Test Name</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${TestName}</div>
                    </td>
                    <td width="2%"></td>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Run Name</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${RunName}</div>
                    </td>
                    <td width="2%"></td>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Test ID</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${TestID}</div>
                    </td>
                </tr>

                <tr><td colspan="1" height="8"></td></tr>

                <tr>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Test Folder</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${TestFolder}</div>
                    </td>
                    <td width="2%"></td>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Test Instance ID</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${TestInstanceID}</div>
                    </td>
                    <td width="2%"></td>
                    <td bgcolor="#f8f9fa" style="border-left:4px solid #667eea; padding:15px;">
                        <div style="font-size:10px; color:#6c757d; font-weight:600; text-transform:uppercase;">Controller</div>
                        <div style="font-size:13px; color:#8737e2; font-weight:500; margin-top:6px;">${Controller}</div>
                    </td>
                </tr>

            </table>
        </td>
    </tr>

    <!-- Load Generators -->
    <tr>
        <td style="padding:25px;">
            <h3 style="margin-bottom:15px; color:#2c3e50;">Load Generators Used</h3>

            <table width="100%" cellpadding="0" cellspacing="0" border="0">
                ${LGsUsed}
            </table>
        </td>
    </tr>

    <!-- Transaction Metrics -->
    <tr>
        <td style="padding:25px;">
            ${TransactionTable}
        </td>
    </tr>


    <!-- CTA (Bulletproof Outlook-safe button) -->
    <tr>
        <td align="center" style="padding:28px; text-align:center;">
            <table border="0" cellspacing="0" cellpadding="0" align="center" style="margin:auto;">
                <tr>
                    <td align="center" bgcolor="#810ece"
                        style="border-radius:6px; mso-padding-alt:13px 26px; background:#810ece;">
                        <!--[if mso]>
                        <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml"
                                     xmlns:w="urn:schemas-microsoft-com:office:word"
                                     href="${ReportLink}"
                                     style="height:40px;v-text-anchor:middle;width:220px;"
                                     arcsize="10%"
                                     strokecolor="#810ece"
                                     fillcolor="#810ece">
                            <w:anchorlock/>
                            <center style="color:#ffffff;font-family:Segoe UI, Tahoma, Geneva, Verdana, sans-serif;font-size:14px;font-weight:600;">
                                View Full Report in LRE
                            </center>
                        </v:roundrect>
                        <![endif]-->
                        <!--[if !mso]><!-->
                        <a href="${ReportLink}"
                           style="background:#810ece;
                    border-radius:6px;
                    color:#ffffff;
                    display:inline-block;
                    font-family:Segoe UI, Tahoma, Geneva, Verdana, sans-serif;
                    font-size:14px;
                    font-weight:600;
                    line-height:40px;
                    text-align:center;
                    text-decoration:none;
                    width:220px;">
                            View Full Report in LRE
                        </a>
                        <!--<![endif]-->
                    </td>
                </tr>
            </table>

            <p style="margin-top:18px; line-height:1.4; font-size:14px; color:#2c3e50;">
                Best regards,<br>The Performance Engineering Team
            </p>
        </td>
    </tr>



    <!-- Footer -->
    <tr>
        <td style="background:#f8f9fa; padding:20px; text-align:center; border-top:1px solid #e9ecef; color:#6c757d; font-size:12px; border-bottom-left-radius:12px; border-bottom-right-radius:12px;">
            <p style="margin:0;">This is an automated message. Please do not reply.</p>
            <p style="margin-top:5px;">Test Run ID: ${RunID} | Duration: ${TestDuration}</p>
        </td>
    </tr>

</table>
</body>
</html>
